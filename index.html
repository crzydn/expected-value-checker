<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ãƒˆãƒ¬ã‚«æœŸå¾…å€¤ãƒã‚§ãƒƒã‚«ãƒ¼ Î²</title>
<meta name="description" content="éŠæˆ¯ç‹ãƒ»ãƒã‚±ã‚«ãƒ»ãƒ´ã‚¡ã‚¤ã‚¹ãªã©ã®ãƒˆãƒ¬ã‚«ãƒœãƒƒã‚¯ã‚¹æœŸå¾…å€¤ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã€‚å¹³å‡è²·å–ãƒ»å›åç‡ã‚’è‡ªå‹•ã§æ¯”è¼ƒã€‚">
<meta property="og:title" content="ãƒˆãƒ¬ã‚«æœŸå¾…å€¤ãƒã‚§ãƒƒã‚«ãƒ¼ Î²">
<meta property="og:description" content="éŠæˆ¯ç‹ãƒ»ãƒã‚±ã‚«ãƒ»ãƒ´ã‚¡ã‚¤ã‚¹ãƒ»ãƒ‡ãƒ¥ã‚¨ãƒå¯¾å¿œã®æœŸå¾…å€¤æ¯”è¼ƒãƒ„ãƒ¼ãƒ«">
<meta property="og:type" content="website">
<meta name="robots" content="index,follow">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.tailwindcss.min.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.tailwindcss.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
</head>

<body class="bg-gray-50 text-gray-900">
  <header class="text-center py-6 border-b border-gray-300 bg-white shadow-sm">
    <h1 class="text-3xl font-bold text-yellow-600">ãƒˆãƒ¬ã‚«æœŸå¾…å€¤ãƒã‚§ãƒƒã‚«ãƒ¼ Î²</h1>
    <p class="text-sm text-gray-600 mt-1">éŠæˆ¯ç‹ãƒ»ãƒã‚±ã‚«ãƒ»ãƒ´ã‚¡ã‚¤ã‚¹ãƒ»ãƒ‡ãƒ¥ã‚¨ãƒå¯¾å¿œ</p>
  </header>

  <main class="max-w-7xl mx-auto px-4 py-8">
    <section id="ranking" class="mb-12">
      <h2 class="text-2xl font-semibold mb-3">ğŸ“Š æœ€æ–°ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h2>
      <table id="torekaTable" class="stripe hover w-full text-sm"></table>
      <p class="text-xs text-gray-500 mt-2">â€»PRã‚’å«ã¿ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã¯å‚è€ƒå€¤ã§ã‚ã‚Šã€æŠ•è³‡åŠ©è¨€ã‚’ç›®çš„ã¨ã—ã¾ã›ã‚“ã€‚</p>
    </section>

    <section id="calc" class="bg-white rounded-xl shadow p-6">
      <h2 class="text-xl font-semibold mb-2">ğŸ§® è‡ªåˆ†ã§è¨ˆç®—ã—ã¦ã¿ã‚‹</h2>
      <form id="calcForm" class="grid grid-cols-2 gap-4">
        <label>ãƒ‘ãƒƒã‚¯å˜ä¾¡ <input type="number" id="packPrice" class="border p-2 w-full" value="200"></label>
        <label>ãƒ‘ãƒƒã‚¯æ•° <input type="number" id="packCount" class="border p-2 w-full" value="30"></label>
        <label>ãƒ¬ã‚¢1 å¹³å‡è²·å– <input type="number" id="r1avg" class="border p-2 w-full" value="900"></label>
        <label>ãƒ¬ã‚¢1 å°å…¥æ•° <input type="number" id="r1cpb" class="border p-2 w-full" value="3"></label>
        <label>ãƒ¬ã‚¢2 å¹³å‡è²·å– <input type="number" id="r2avg" class="border p-2 w-full" value="450"></label>
        <label>ãƒ¬ã‚¢2 å°å…¥æ•° <input type="number" id="r2cpb" class="border p-2 w-full" value="6"></label>
      </form>
      <button id="calcBtn" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded mt-4">è¨ˆç®—ã™ã‚‹</button>
      <div id="calcResult" class="mt-4 text-lg font-semibold"></div>
    </section>
  </main>

  <footer class="text-center text-gray-600 text-sm py-6 border-t border-gray-200 bg-gray-100">
    <p>Â© 2025 ãƒˆãƒ¬ã‚«æœŸå¾…å€¤ãƒã‚§ãƒƒã‚«ãƒ¼ Î² | å‚è€ƒãƒ‡ãƒ¼ã‚¿ï¼šCardRush / yugioh-starter.com</p>
  </footer>

<script src="js/main.js">
  // js/main.js
$(document).ready(function () {
  fetch("data/torekadata.json")
    .then((r) => r.json())
    .then((data) => initTable(data))
    .catch(() => $("#torekaTable").html("<tr><td>ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸã€‚</td></tr>"));

  function initTable(data) {
    const columns = [
      { title: "ã‚²ãƒ¼ãƒ ", data: "game" },
      { title: "ãƒœãƒƒã‚¯ã‚¹å", data: "boxName" },
      { title: "ç™ºå£²æ—¥", data: "releaseDate" },
      { title: "ç®±ä¾¡æ ¼", data: "boxPrice" },
      { title: "æœŸå¾…å€¤(åˆè¨ˆ)", data: "avgBuyTotal" },
      { title: "1ãƒ‘ãƒƒã‚¯EV", data: "packEV" },
      { title: "å›åç‡", data: "roi_pct" },
      {
        title: "ã‚¢ãƒ•ã‚£ãƒªãƒ³ã‚¯",
        data: "affiliateUrl",
        render: function (url, type, row) {
          return `<a href="${url}" target="_blank" class="text-yellow-600 underline">è¦‹ã‚‹</a>`;
        },
      },
    ];

    $("#torekaTable").DataTable({
      data: data,
      columns: columns,
      order: [[6, "desc"]],
      pageLength: 10,
      responsive: true,
    });
  }

  // è¨ˆç®—ãƒ•ã‚©ãƒ¼ãƒ 
  $("#calcBtn").on("click", function () {
    const packPrice = parseFloat($("#packPrice").val()) || 0;
    const packCount = parseFloat($("#packCount").val()) || 0;
    const rarities = [
      { avg: parseFloat($("#r1avg").val()) || 0, cpb: parseFloat($("#r1cpb").val()) || 0 },
      { avg: parseFloat($("#r2avg").val()) || 0, cpb: parseFloat($("#r2cpb").val()) || 0 },
    ];
    const boxPrice = packPrice * packCount;
    const avgBuyTotal = rarities.reduce((s, r) => s + r.avg * r.cpb, 0);
    const packEV = (avgBuyTotal / packCount).toFixed(0);
    const roi = (avgBuyTotal / boxPrice).toFixed(2);
    const roiPct = (roi * 100).toFixed(1) + "%";
    $("#calcResult").html(`ç®±ä¾¡æ ¼ï¼š${boxPrice}å†† ï¼ æœŸå¾…å€¤ï¼š${avgBuyTotal}å†† ï¼ ROIï¼š${roiPct}`);
  });
});

</script>
</body>
</html>
